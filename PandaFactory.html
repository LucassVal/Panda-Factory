<!doctype html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Panda Fabrics üêº</title>

    <!-- PWA Setup -->
    <link rel="manifest" href="manifest.json" />
    <meta name="theme-color" content="#667eea" />
    <link rel="icon" type="image/png" href="icons/icon-192x192.png" />
    <link rel="apple-touch-icon" href="icons/icon-192x192.png" />

    <!-- üé® PANDA UNIFIED THEME -->
    <link rel="stylesheet" href="css/pf.theme.css?v=3.1" />

    <!-- Chart.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- PANDA SYSTEM CORE (Isolated Kernel) -->
    <script src="_system/sdk/repository.js?v=sys_v1"></script>
    <script src="_system/sdk/api.js?v=sys_v1"></script>
    <script src="_system/core/kernel.js?v=sys_v1"></script>

    <!-- üêº PANDA SDK MOCK (Governance + PAT) -->
    <script src="js/pf.sdk.js?v=0.8"></script>

    <!-- üöÄ APP INITIALIZATION -->
    <script src="js/pf.app-init.js?v=1.1" defer></script>

    <!-- üß© MODULAR UI CONTROLLERS -->
    <script src="js/ui/pf.omnibar.js?v=2.0" defer></script>
    <script src="js/ui/pf.modal-pin.js?v=1.0" defer></script>
    <script src="js/ui/pf.settings.js?v=1.0" defer></script>
    <script src="js/ui/pf.dock-drag.js?v=1.0" defer></script>
    <script src="js/ui/pf.devtools.js?v=1.0" defer></script>

    <!-- üß† PANDA AI CORE (PAT) -->
    <script src="js/core/pf.ai-core.js?v=1.0" defer></script>
    <script src="js/core/pf.firebase-bridge.js?v=1.0" defer></script>
  </head>

  <body>
    <!-- üêº LOADING SCREEN -->
    <div id="panda-loading" class="panda-loading-screen">
      <img src="assets/panda_logo.jpg" alt="Panda" class="panda-loading-logo" />
    </div>

    <!-- üéØ MAIN CONTAINER -->
    <div class="container">
      <!-- COMPONENT CONTAINERS (Loaded by loader.js) -->
      <div id="header-container"></div>
      <div id="app-dock-container"></div>
      <div id="dev-dock-container"></div>
      <div id="settings-modal-container"></div>
      <div id="sidebar-container"></div>

      <!-- IN√çCIO VIEW (Clean Canvas) -->
      <div id="inicio-view" class="view-section active clean-canvas">
        <img
          src="assets/panda_logo.jpg"
          alt="Panda Fabrics"
          class="canvas-logo"
        />
      </div>
    </div>

    <!-- Component Loader Script (System Core) -->
    <script src="_system/core/loader.js"></script>

    <!-- Legacy Core (CRM) -->
    <script
      src="js/panda.core.js"
      onerror="console.log('panda.core.js not found')"
    ></script>
    <script
      src="dados/auto_import.js"
      onerror="console.log('Nenhum dado do scraper')"
    ></script>

    <script>
      // PWA Service Worker Registration
      if ("serviceWorker" in navigator) {
        window.addEventListener("load", function () {
          navigator.serviceWorker
            .register("./sw.js")
            .then((reg) => console.log("üêº ServiceWorker OK:", reg.scope))
            .catch((err) => console.log("‚ùå ServiceWorker falhou:", err));
        });
      }
    </script>

    <style>
      /* Loading Screen Styles */
      .panda-loading-screen {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: var(--ds-background-100, #0a0a0f);
        z-index: 9999;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: opacity 0.5s ease-out;
      }

      .panda-loading-logo {
        width: 150px;
        height: 150px;
        object-fit: contain;
        animation: pulsePanda 1.5s ease-in-out infinite;
      }

      @keyframes pulsePanda {
        0%,
        100% {
          transform: scale(1);
          opacity: 1;
        }
        50% {
          transform: scale(1.05);
          opacity: 0.8;
        }
      }

      /* Clean Canvas */
      .clean-canvas {
        position: relative;
        width: 100%;
        height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        background: var(--ds-background-100, #0a0a0f);
      }

      .canvas-logo {
        width: 200px;
        height: 200px;
        object-fit: contain;
        opacity: 0.3;
      }
    </style>
  </body>
</html>
